{"remainingRequest":"/Users/apple/github/glsnb/glsblc/glsblc/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/apple/github/glsnb/glsblc/glsblc/node_modules/form-generator-iview/src/fields/fieldMediaUpload.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/apple/github/glsnb/glsblc/glsblc/node_modules/form-generator-iview/src/fields/fieldMediaUpload.vue","mtime":1576581289804},{"path":"/Users/apple/github/glsnb/glsblc/glsblc/node_modules/cache-loader/dist/cjs.js","mtime":1576575745336},{"path":"/Users/apple/github/glsnb/glsblc/glsblc/node_modules/thread-loader/dist/cjs.js","mtime":1575878146703},{"path":"/Users/apple/github/glsnb/glsblc/glsblc/node_modules/babel-loader/lib/index.js","mtime":1575878134225},{"path":"/Users/apple/github/glsnb/glsblc/glsblc/node_modules/cache-loader/dist/cjs.js","mtime":1576575745336},{"path":"/Users/apple/github/glsnb/glsblc/glsblc/node_modules/vue-loader/lib/index.js","mtime":1576575752870}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCgppbXBvcnQge2NsYXNzUHJpZml4fSBmcm9tICcuLi91dGlscy9jb25zdCc7CmNvbnN0IGRlZmF1bHRJbWdFeHRlbnNpb25zID0gWydnaWYnLCAnanBnJywgJ2pwZWcnLCAncG5nJ107CmNvbnN0IGRlZmF1bHRWaWRlb0V4dGVuc2lvbnMgPSBbJ21wNCcsICcud2VibSddOwpleHBvcnQgZGVmYXVsdCB7CiAgICBpbmplY3Q6IFsnZm9ybSddLAogICAgLy8gcHJvcHMgbWF5IGZyb20gaW1nVXBsb2FkIG9yIHZpZGVvVXBsb2FkCiAgICBwcm9wczogewogICAgICAgIGZpZWxkOiB7CiAgICAgICAgICAgIHR5cGU6IE9iamVjdCwKICAgICAgICAgICAgcmVxdWlyZWQ6IHRydWUKICAgICAgICB9LAogICAgICAgIHNpemU6IHsKICAgICAgICAgICAgdHlwZTogU3RyaW5nLAogICAgICAgICAgICBkZWZhdWx0KCkgewogICAgICAgICAgICAgICAgcmV0dXJuICdkZWZhdWx0JzsKICAgICAgICAgICAgfQogICAgICAgIH0sCiAgICAgICAgYWNjZXB0OiB7CiAgICAgICAgICAgIHR5cGU6IFN0cmluZywKICAgICAgICAgICAgZGVmYXVsdDogJ2ltYWdlL2dpZiwgaW1hZ2UvanBlZywgaW1hZ2UvcG5nLCB2aWRlby9tcDQnCiAgICAgICAgfSwKICAgICAgICBmb3JtYXQ6IHsKICAgICAgICAgICAgdHlwZTogQXJyYXksCiAgICAgICAgICAgIGRlZmF1bHQoKSB7CiAgICAgICAgICAgICAgICByZXR1cm4gWy4uLmRlZmF1bHRJbWdFeHRlbnNpb25zLCAuLi5kZWZhdWx0VmlkZW9FeHRlbnNpb25zXTsKICAgICAgICAgICAgfQogICAgICAgIH0KICAgIH0sCiAgICBkYXRhKCkgewogICAgICAgIHJldHVybiB7CiAgICAgICAgICAgIHByZXZpZXdNb2RhbDogewogICAgICAgICAgICAgICAgb3BlbjogZmFsc2UsCiAgICAgICAgICAgICAgICBmaWxlOiB7fQogICAgICAgICAgICB9LAogICAgICAgICAgICB1cGxvYWRGaWxlTGlzdDogW10sCiAgICAgICAgICAgIGRlZmF1bHRGaWxlTGlzdDogW10sCiAgICAgICAgICAgIGxvYWRpbmc6IGZhbHNlLAogICAgICAgICAgICB1cGxvYWRlcjogbnVsbAogICAgICAgIH07CiAgICB9LAogICAgY29tcHV0ZWQ6IHsKICAgICAgICBjbGFzc2VzKCkgewogICAgICAgICAgICByZXR1cm4gYCR7Y2xhc3NQcmlmaXh9LW1lZGlhdXBsb2FkYDsKICAgICAgICB9LAogICAgICAgIGZpbGVMaXN0Q2xhc3MoKSB7CiAgICAgICAgICAgIHJldHVybiBgJHt0aGlzLmNsYXNzZXN9LWZpbGUtbGlzdGA7CiAgICAgICAgfSwKICAgICAgICBmaWxlTGlzdEl0ZW1DbGFzcygpIHsKICAgICAgICAgICAgcmV0dXJuIGAke3RoaXMuY2xhc3Nlc30tZmlsZS1saXN0LWl0ZW1gOwogICAgICAgIH0sCiAgICAgICAgZmlsZUxpc3RJdGVtTWVkaWFDbGFzcygpIHsKICAgICAgICAgICAgcmV0dXJuIGAke3RoaXMuY2xhc3Nlc30tZmlsZS1saXN0LWl0ZW0tbWVkaWFgOwogICAgICAgIH0sCiAgICAgICAgZmlsZUxpc3RJdGVtTmFtZUNsYXNzKCkgewogICAgICAgICAgICByZXR1cm4gYCR7dGhpcy5jbGFzc2VzfS1maWxlLWxpc3QtaXRlbS1uYW1lYDsKICAgICAgICB9LAogICAgICAgIGZpbGVMaXN0SXRlbVJlbW92ZUNsYXNzKCkgewogICAgICAgICAgICByZXR1cm4gYCR7dGhpcy5jbGFzc2VzfS1maWxlLWxpc3QtaXRlbS1yZW1vdmVgOwogICAgICAgIH0sCiAgICAgICAgZmlsZUxpc3RJdGVtRWRpdENsYXNzKCkgewogICAgICAgICAgICByZXR1cm4gYCR7dGhpcy5jbGFzc2VzfS1maWxlLWxpc3QtaXRlbS1lZGl0YDsKICAgICAgICB9LAogICAgICAgIHByZXZpZXdNb2RhbE1lZGlhQ2xhc3NlcygpIHsKICAgICAgICAgICAgcmV0dXJuIGAke3RoaXMuY2xhc3Nlc30tbW9kYWwtcHJldmlldy1tZWRpYWA7CiAgICAgICAgfSwKICAgICAgICBwcmV2aWV3RmlsZSgpIHsKICAgICAgICAgICAgcmV0dXJuIHRoaXMucHJldmlld01vZGFsLmZpbGUgfHwge307CiAgICAgICAgfSwKICAgICAgICBjb21wdXRlZEFjY2VwdCgpIHsKICAgICAgICAgICAgcmV0dXJuIHRoaXMuZmllbGQuYWNjZXB0IHx8IHRoaXMuYWNjZXB0OwogICAgICAgIH0sCiAgICAgICAgY29tcHV0ZWRGb3JtYXQoKSB7CiAgICAgICAgICAgIHJldHVybiB0aGlzLmZpZWxkLmZvcm1hdCB8fCB0aGlzLmZvcm1hdDsKICAgICAgICB9LAogICAgICAgIHRpcCgpIHsKICAgICAgICAgICAgcmV0dXJuIHRoaXMuZmllbGQudGlwIHx8ICfngrnlh7vmiJbogIXmi5bmi73mlofku7bljbPlj6/kuIrkvKAnOwogICAgICAgIH0sCiAgICAgICAgdmFsdWUoKSB7CiAgICAgICAgICAgIGxldCB2YWx1ZSA9IHRoaXMuZm9ybS5tb2RlbFt0aGlzLmZpZWxkLm1vZGVsXSB8fCBbXTsKICAgICAgICAgICAgcmV0dXJuIHZhbHVlLm1hcChpdGVtID0+IHsKICAgICAgICAgICAgICAgIGl0ZW0uc3RhdHVzID0gJ2ZpbmlzaGVkJzsKICAgICAgICAgICAgICAgIHJldHVybiBpdGVtOwogICAgICAgICAgICB9KTsKICAgICAgICB9CiAgICB9LAogICAgd2F0Y2g6IHsKICAgICAgICB2YWx1ZSh2YWx1ZSkgewogICAgICAgICAgICB0aGlzLnVwbG9hZEZpbGVMaXN0ID0gdmFsdWU7CiAgICAgICAgICAgIGlmICh0aGlzLnVwbG9hZGVyKSB7CiAgICAgICAgICAgICAgICB0aGlzLnVwbG9hZGVyLmZpbGVMaXN0ID0gdGhpcy51cGxvYWRGaWxlTGlzdDsKICAgICAgICAgICAgfQogICAgICAgIH0sCiAgICB9LAogICAgbW91bnRlZCgpIHsKICAgICAgICB0aGlzLnVwbG9hZGVyID0gdGhpcy4kcmVmcy51cGxvYWQgfHwgdGhpcy4kcmVmcy5tZWRpYVVwbG9hZC4kcmVmcy51cGxvYWQ7CiAgICAgICAgdGhpcy51cGxvYWRlci5maWxlTGlzdCA9IHRoaXMudmFsdWU7CiAgICAgICAgdGhpcy51cGxvYWRGaWxlTGlzdCA9IHRoaXMudXBsb2FkZXIuZmlsZUxpc3Q7CiAgICB9LAogICAgbWV0aG9kczogewogICAgICAgIG9uUmVtb3ZlKGZpbGUpIHsKICAgICAgICAgICAgY29uc3QgZmlsZUxpc3QgPSB0aGlzLnVwbG9hZGVyLmZpbGVMaXN0OwogICAgICAgICAgICB0aGlzLnVwbG9hZGVyLmZpbGVMaXN0LnNwbGljZShmaWxlTGlzdC5pbmRleE9mKGZpbGUpLCAxKTsKICAgICAgICAgICAgdGhpcy51cGxvYWRGaWxlTGlzdCA9IHRoaXMudXBsb2FkZXIuZmlsZUxpc3Quc2xpY2UoKTsKICAgICAgICAgICAgdGhpcy5oYW5kbGVDaGFuZ2UoKTsKICAgICAgICB9LAogICAgICAgIG9uUHJvZ3Jlc3MoZXZlbnQsIGZpbGUsIGZpbGVMaXN0KSB7CiAgICAgICAgICAgIHRoaXMudXBsb2FkRmlsZUxpc3QgPSBmaWxlTGlzdDsKICAgICAgICB9LAogICAgICAgIG9uU3VjY2Vzcyh7ZGF0YSA9IHt9fSwgZmlsZSkgewogICAgICAgICAgICBjb25zdCB7dXJsfSA9IGRhdGE7CiAgICAgICAgICAgIGlmICh1cmwpIHsKICAgICAgICAgICAgICAgIC8vIHRoaXMuJE1lc3NhZ2UuaW5mbygn5LiK5Lyg5oiQ5YqfIScpOwogICAgICAgICAgICAgICAgZmlsZS51cmwgPSB1cmw7CiAgICAgICAgICAgICAgICB0aGlzLnVwbG9hZEZpbGVMaXN0ID0gdGhpcy51cGxvYWRlci5maWxlTGlzdDsKICAgICAgICAgICAgICAgIHRoaXMuaGFuZGxlQ2hhbmdlKCk7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgZWxzZSB7CiAgICAgICAgICAgICAgICB0aGlzLm9uUmVtb3ZlKGZpbGUpOwogICAgICAgICAgICAgICAgdGhpcy4kTWVzc2FnZS5lcnJvcign5LiK5Lyg5aSx6LSlIScpOwogICAgICAgICAgICB9CiAgICAgICAgfSwKICAgICAgICBvbkZvcm1hdEVycm9yKCkgewogICAgICAgICAgICB0aGlzLiRNZXNzYWdlLmVycm9yKHsKICAgICAgICAgICAgICAgIGNvbnRlbnQ6IGDkuIrkvKDmlofku7bmoLzlvI/pnIDkuLo6JHt0aGlzLmZpZWxkLmFjY2VwdH0s5LiU5ZCO57yA5ZCN5Li6OiR7dGhpcy5maWVsZC5mb3JtYXR9YCwKICAgICAgICAgICAgICAgIGR1cmF0aW9uOiAyLAogICAgICAgICAgICB9KTsKICAgICAgICB9LAogICAgICAgIG9uRXhjZWVkZWRTaXplKCkgewogICAgICAgICAgICB0aGlzLiRNZXNzYWdlLmVycm9yKHsKICAgICAgICAgICAgICAgIGNvbnRlbnQ6IGDkuIrkvKDmlofku7blpKflsI/kuI3og73otoXov4c6JHt0aGlzLmZpZWxkLm1heFNpemUgLyAxMDI0fU1CYCwKICAgICAgICAgICAgICAgIGR1cmF0aW9uOiAyLAogICAgICAgICAgICB9KTsKICAgICAgICB9LAogICAgICAgIGhhbmRsZUNoYW5nZSgpIHsKICAgICAgICAgICAgdGhpcy4kc2V0KHRoaXMuZm9ybS5tb2RlbCwgdGhpcy5maWVsZC5tb2RlbCwgdGhpcy51cGxvYWRGaWxlTGlzdCk7CiAgICAgICAgICAgIHRoaXMuJGVtaXQoJ29uLWNoYW5nZScsIHRoaXMuZmllbGQubW9kZWwsIHRoaXMudXBsb2FkRmlsZUxpc3QsIG51bGwsIHRoaXMuZmllbGQpOwogICAgICAgIH0sCiAgICAgICAgaGFuZGxlUmVtb3ZlKGUsIGZpbGUpIHsKICAgICAgICAgICAgaWYgKGUpIHsKICAgICAgICAgICAgICAgIGUuc3RvcFByb3BhZ2F0aW9uKCk7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgdGhpcy5vblJlbW92ZShmaWxlKTsKICAgICAgICB9LAogICAgICAgIGhhbmRsZVBvcHRpcENsaWNrKGUpIHsKICAgICAgICAgICAgaWYgKGUpIHsKICAgICAgICAgICAgICAgIGUuc3RvcFByb3BhZ2F0aW9uKCk7CiAgICAgICAgICAgIH0KICAgICAgICB9LAogICAgICAgIGhhbmRsZUZpbGVOYW1lSW5wdXQodmFsdWUsIGluZGV4KSB7CiAgICAgICAgICAgIGNvbnN0IGxpc3QgPSB0aGlzLnVwbG9hZEZpbGVMaXN0Lm1hcCgoZmlsZSwgaSkgPT4gewogICAgICAgICAgICAgICAgaWYgKGluZGV4ICE9PSBpKSB7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZpbGU7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBlbHNlIHsKICAgICAgICAgICAgICAgICAgICByZXR1cm4gewogICAgICAgICAgICAgICAgICAgICAgICAuLi5maWxlLAogICAgICAgICAgICAgICAgICAgICAgICBuYW1lOiB2YWx1ZQogICAgICAgICAgICAgICAgICAgIH07CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0pOwogICAgICAgICAgICB0aGlzLnVwbG9hZEZpbGVMaXN0ID0gbGlzdDsKICAgICAgICAgICAgdGhpcy5oYW5kbGVDaGFuZ2UoKTsKICAgICAgICB9LAogICAgICAgIGhhbmRsZVNtYWxsTWVkaWFDbGljayhlLCBpbmRleCkgewogICAgICAgICAgICBpZiAoZSkgewogICAgICAgICAgICAgICAgZS5zdG9wUHJvcGFnYXRpb24oKTsKICAgICAgICAgICAgfQogICAgICAgICAgICB0aGlzLnByZXZpZXdNb2RhbCA9IHsKICAgICAgICAgICAgICAgIG9wZW46IHRydWUsCiAgICAgICAgICAgICAgICBmaWxlOiB0aGlzLnVwbG9hZEZpbGVMaXN0W2luZGV4XQogICAgICAgICAgICB9OwogICAgICAgIH0sCiAgICAgICAgLy8g6YCa6L+HVVJM5ZKMCiAgICAgICAgaXNJbWFnZSh7bmFtZSA9ICcnLCB1cmwgPSAnJ30pIHsKICAgICAgICAgICAgcmV0dXJuIGRlZmF1bHRJbWdFeHRlbnNpb25zLnNvbWUoaXRlbSA9PiB7CiAgICAgICAgICAgICAgICBjb25zdCByZWcgPSBuZXcgUmVnRXhwKGAuJHtpdGVtfSRgKTsKICAgICAgICAgICAgICAgIHJldHVybiByZWcudGVzdChuYW1lKSB8fCByZWcudGVzdCh1cmwpOwogICAgICAgICAgICB9KTsKICAgICAgICB9LAogICAgfQp9Owo="},{"version":3,"sources":["fieldMediaUpload.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAgHA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"fieldMediaUpload.vue","sourceRoot":"node_modules/form-generator-iview/src/fields","sourcesContent":["<template>\n    <div :class=\"classes\">\n        <Upload\n            ref=\"upload\"\n            :action=\"field.action\"\n            :headers=\"field.headers\"\n            :multiple=\"field.multiple\"\n            :paste=\"field.paste\"\n            :disabled=\"field.disabled\"\n            :data=\"field.data\"\n            :name=\"field.name\"\n            :with-credentials=\"field.withCredentials\"\n            :show-upload-list=\"false\"\n            :type=\"field.subtype\"\n            :accept=\"computedAccept\"\n            :format=\"computedFormat\"\n            :max-size=\"field.maxSize\"\n            :default-file-list=\"defaultFileList\"\n            :on-format-error=\"onFormatError\"\n            :on-exceeded-size=\"onExceededSize\"\n            :on-success=\"onSuccess\"\n            :on-progress=\"onProgress\"\n            :size=\"size\"\n        >\n            <Icon\n                type=\"ios-cloud-upload\"\n                size=\"20\"\n                style=\"color: #3399ff\"\n            />\n            <p v-html=\"tip\" />\n            <ul :class=\"fileListClass\">\n                <li\n                    v-for=\"(file, index) in uploadFileList\"\n                    :key=\"index\"\n                    :class=\"fileListItemClass\"\n                >\n                    <template v-if=\"file.status === 'finished'\">\n                        <img\n                            v-if=\"isImage(file)\"\n                            :class=\"fileListItemMediaClass\"\n                            :src=\"file.url\"\n                            :alt=\"file.name\"\n                            @click=\"handleSmallMediaClick($event, index)\"\n                        >\n                        <video\n                            v-else\n                            :class=\"fileListItemMediaClass\"\n                            :src=\"file.url\"\n                            @click=\"handleSmallMediaClick($event, index)\"\n                        />\n                        <span\n                            :class=\"fileListItemNameClass\"\n                            :title=\"file.name\"\n                        >{{ file.name }}</span>\n                        <Poptip\n                            :class=\"fileListItemEditClass\"\n                            title=\"编辑文件名称\"\n                            @click.native=\"handlePoptipClick\"\n                        >\n                            <div slot=\"content\">\n                                <Input\n                                    type=\"textarea\"\n                                    size=\"small\"\n                                    autosize\n                                    :value=\"file.name\"\n                                    @input=\"handleFileNameInput($event, index)\"\n                                />\n                            </div>\n                            <Icon\n                                :size=\"24\"\n                                style=\"color: #FFF\"\n                                type=\"ios-create-outline\"\n                            />\n                        </Poptip>\n                        <Icon\n                            :class=\"fileListItemRemoveClass\"\n                            :size=\"24\"\n                            style=\"color: #FFF\"\n                            type=\"ios-trash-outline\"\n                            @click=\"handleRemove($event, file)\"\n                        />\n                    </template>\n                    <template v-else>\n                        <Progress :percent=\"file.percentage\" hide-info />\n                    </template>\n                </li>\n            </ul>\n        </Upload>\n        <Modal\n            v-model=\"previewModal.open\"\n            title=\"预览\"\n            draggable\n            footer-hide\n            mask-closable\n        >\n            <img\n                v-if=\"isImage(previewFile)\"\n                :src=\"previewFile.url\"\n                :alt=\"previewFile.name\"\n                :class=\"previewModalMediaClasses\"\n            >\n            <video\n                v-else\n                :src=\"previewFile.url\"\n                :class=\"previewModalMediaClasses\"\n                controls\n            />\n        </Modal>\n    </div>\n</template>\n<script>\n\nimport {classPrifix} from '../utils/const';\nconst defaultImgExtensions = ['gif', 'jpg', 'jpeg', 'png'];\nconst defaultVideoExtensions = ['mp4', '.webm'];\nexport default {\n    inject: ['form'],\n    // props may from imgUpload or videoUpload\n    props: {\n        field: {\n            type: Object,\n            required: true\n        },\n        size: {\n            type: String,\n            default() {\n                return 'default';\n            }\n        },\n        accept: {\n            type: String,\n            default: 'image/gif, image/jpeg, image/png, video/mp4'\n        },\n        format: {\n            type: Array,\n            default() {\n                return [...defaultImgExtensions, ...defaultVideoExtensions];\n            }\n        }\n    },\n    data() {\n        return {\n            previewModal: {\n                open: false,\n                file: {}\n            },\n            uploadFileList: [],\n            defaultFileList: [],\n            loading: false,\n            uploader: null\n        };\n    },\n    computed: {\n        classes() {\n            return `${classPrifix}-mediaupload`;\n        },\n        fileListClass() {\n            return `${this.classes}-file-list`;\n        },\n        fileListItemClass() {\n            return `${this.classes}-file-list-item`;\n        },\n        fileListItemMediaClass() {\n            return `${this.classes}-file-list-item-media`;\n        },\n        fileListItemNameClass() {\n            return `${this.classes}-file-list-item-name`;\n        },\n        fileListItemRemoveClass() {\n            return `${this.classes}-file-list-item-remove`;\n        },\n        fileListItemEditClass() {\n            return `${this.classes}-file-list-item-edit`;\n        },\n        previewModalMediaClasses() {\n            return `${this.classes}-modal-preview-media`;\n        },\n        previewFile() {\n            return this.previewModal.file || {};\n        },\n        computedAccept() {\n            return this.field.accept || this.accept;\n        },\n        computedFormat() {\n            return this.field.format || this.format;\n        },\n        tip() {\n            return this.field.tip || '点击或者拖拽文件即可上传';\n        },\n        value() {\n            let value = this.form.model[this.field.model] || [];\n            return value.map(item => {\n                item.status = 'finished';\n                return item;\n            });\n        }\n    },\n    watch: {\n        value(value) {\n            this.uploadFileList = value;\n            if (this.uploader) {\n                this.uploader.fileList = this.uploadFileList;\n            }\n        },\n    },\n    mounted() {\n        this.uploader = this.$refs.upload || this.$refs.mediaUpload.$refs.upload;\n        this.uploader.fileList = this.value;\n        this.uploadFileList = this.uploader.fileList;\n    },\n    methods: {\n        onRemove(file) {\n            const fileList = this.uploader.fileList;\n            this.uploader.fileList.splice(fileList.indexOf(file), 1);\n            this.uploadFileList = this.uploader.fileList.slice();\n            this.handleChange();\n        },\n        onProgress(event, file, fileList) {\n            this.uploadFileList = fileList;\n        },\n        onSuccess({data = {}}, file) {\n            const {url} = data;\n            if (url) {\n                // this.$Message.info('上传成功!');\n                file.url = url;\n                this.uploadFileList = this.uploader.fileList;\n                this.handleChange();\n            }\n            else {\n                this.onRemove(file);\n                this.$Message.error('上传失败!');\n            }\n        },\n        onFormatError() {\n            this.$Message.error({\n                content: `上传文件格式需为:${this.field.accept},且后缀名为:${this.field.format}`,\n                duration: 2,\n            });\n        },\n        onExceededSize() {\n            this.$Message.error({\n                content: `上传文件大小不能超过:${this.field.maxSize / 1024}MB`,\n                duration: 2,\n            });\n        },\n        handleChange() {\n            this.$set(this.form.model, this.field.model, this.uploadFileList);\n            this.$emit('on-change', this.field.model, this.uploadFileList, null, this.field);\n        },\n        handleRemove(e, file) {\n            if (e) {\n                e.stopPropagation();\n            }\n            this.onRemove(file);\n        },\n        handlePoptipClick(e) {\n            if (e) {\n                e.stopPropagation();\n            }\n        },\n        handleFileNameInput(value, index) {\n            const list = this.uploadFileList.map((file, i) => {\n                if (index !== i) {\n                    return file;\n                }\n                else {\n                    return {\n                        ...file,\n                        name: value\n                    };\n                }\n            });\n            this.uploadFileList = list;\n            this.handleChange();\n        },\n        handleSmallMediaClick(e, index) {\n            if (e) {\n                e.stopPropagation();\n            }\n            this.previewModal = {\n                open: true,\n                file: this.uploadFileList[index]\n            };\n        },\n        // 通过URL和\n        isImage({name = '', url = ''}) {\n            return defaultImgExtensions.some(item => {\n                const reg = new RegExp(`.${item}$`);\n                return reg.test(name) || reg.test(url);\n            });\n        },\n    }\n};\n</script>\n"]}]}