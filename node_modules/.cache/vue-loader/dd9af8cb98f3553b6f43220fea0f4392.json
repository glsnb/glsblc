{"remainingRequest":"/Users/apple/github/glsnb/glsblc/glsblc/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/apple/github/glsnb/glsblc/glsblc/node_modules/form-generator-iview/src/fields/fieldButton.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/apple/github/glsnb/glsblc/glsblc/node_modules/form-generator-iview/src/fields/fieldButton.vue","mtime":1576581289804},{"path":"/Users/apple/github/glsnb/glsblc/glsblc/node_modules/cache-loader/dist/cjs.js","mtime":1576575745336},{"path":"/Users/apple/github/glsnb/glsblc/glsblc/node_modules/thread-loader/dist/cjs.js","mtime":1575878146703},{"path":"/Users/apple/github/glsnb/glsblc/glsblc/node_modules/babel-loader/lib/index.js","mtime":1575878134225},{"path":"/Users/apple/github/glsnb/glsblc/glsblc/node_modules/cache-loader/dist/cjs.js","mtime":1576575745336},{"path":"/Users/apple/github/glsnb/glsblc/glsblc/node_modules/vue-loader/lib/index.js","mtime":1576575752870}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCBheGlvcyBmcm9tICcuLi91dGlscy9odHRwJzsKaW1wb3J0IHtjbGFzc1ByaWZpeH0gZnJvbSAnLi4vdXRpbHMvY29uc3QnOwpleHBvcnQgZGVmYXVsdCB7CiAgICBpbmplY3Q6IFsnZm9ybSddLAogICAgcHJvcHM6IHsKICAgICAgICBmaWVsZDogewogICAgICAgICAgICB0eXBlOiBPYmplY3QsCiAgICAgICAgICAgIHJlcXVpcmVkOiB0cnVlCiAgICAgICAgfSwKICAgICAgICBhcGlCYXNlOiB7CiAgICAgICAgICAgIHR5cGU6IFN0cmluZywKICAgICAgICAgICAgZGVmYXVsdDogJycKICAgICAgICB9CiAgICB9LAogICAgZGF0YSgpIHsKICAgICAgICByZXR1cm4gewogICAgICAgICAgICB0ZXh0OiAnJwogICAgICAgIH07CiAgICB9LAogICAgY29tcHV0ZWQ6IHsKICAgICAgICBjbGFzc2VzKCkgewogICAgICAgICAgICByZXR1cm4gYCR7Y2xhc3NQcmlmaXh9LSR7dGhpcy5maWVsZC50eXBlLnRvTG93ZXJDYXNlKCl9YDsKICAgICAgICB9LAogICAgfSwKICAgIG1vdW50ZWQoKSB7CiAgICAgICAgdGhpcy50ZXh0ID0gdGhpcy5maWVsZC50ZXh0OwogICAgfSwKICAgIG1ldGhvZHM6IHsKICAgICAgICBoYW5kbGVDbGljaygpIHsKICAgICAgICAgICAgc3dpdGNoICh0aGlzLmZpZWxkLmFjdGlvbi50eXBlKSB7CiAgICAgICAgICAgICAgICBjYXNlICdhamF4JzoKICAgICAgICAgICAgICAgICAgICB0aGlzLmRvQWpheEFjdGlvbigpOwogICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgY2FzZSAnZXZlbnQnOgogICAgICAgICAgICAgICAgICAgIHRoaXMuJGVtaXQoJ29uLWJ1dHRvbi1jbGljaycsIHsKICAgICAgICAgICAgICAgICAgICAgICAgbmFtZTogdGhpcy5maWVsZC5hY3Rpb24ubmFtZQogICAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICB9CiAgICAgICAgfSwKICAgICAgICBkb0FqYXhBY3Rpb24oKSB7CiAgICAgICAgICAgIHRoaXMubG9hZGluZyA9IHRydWU7CiAgICAgICAgICAgIGxldCBhcGlCYXNlID0gdGhpcy5hcGlCYXNlIHx8ICcnOwogICAgICAgICAgICBsZXQgZm9ybU1vZGVsID0gdGhpcy5mb3JtLm1vZGVsOwogICAgICAgICAgICBsZXQgYXBpUGFyYW1zID0gdGhpcy5maWVsZC5hcGlQYXJhbXMgfHwgW107CiAgICAgICAgICAgIGxldCBwYXJhbXMgPSB7fTsKICAgICAgICAgICAgbGV0IGZpbmFsQXBpID0gYXBpQmFzZSArIHRoaXMuZmllbGQuYWN0aW9uLmFwaTsKICAgICAgICAgICAgYXBpUGFyYW1zLmZvckVhY2gocGFyYW0gPT4gewogICAgICAgICAgICAgICAgcGFyYW1zW3BhcmFtXSA9IGZvcm1Nb2RlbFtwYXJhbV07CiAgICAgICAgICAgIH0pOwogICAgICAgICAgICBsZXQgZmluYWxQYXJhbXMgPSBPYmplY3QuYXNzaWduKHt9LCBwYXJhbXMpOwogICAgICAgICAgICB0aGlzLnJlcXVlc3RNZXRob2QoZmluYWxBcGksIGZpbmFsUGFyYW1zKS50aGVuKHJlcyA9PiB7CiAgICAgICAgICAgICAgICB0aGlzLnJlcXVlc3RSZXNvbHZlKHJlcyk7CiAgICAgICAgICAgIH0sIHJlamVjdCA9PiB7CiAgICAgICAgICAgICAgICB0aGlzLnJlcXVlc3RSZWplY3QocmVqZWN0KTsKICAgICAgICAgICAgfSk7CiAgICAgICAgfSwKICAgICAgICByZXF1ZXN0UmVzb2x2ZShyZXMpIHsKICAgICAgICAgICAgaWYgKCtyZXMuc3RhdHVzID09PSAwIHx8ICtyZXMuZXJybm8gPT09IDAgfHwgK3Jlcy5zdGF0dXMgPT09IDIwMCkgewogICAgICAgICAgICAgICAgdGhpcy50ZXh0ID0gcmVzLmRhdGEudGV4dDsKICAgICAgICAgICAgICAgIHRoaXMubG9hZGluZyA9IGZhbHNlOwogICAgICAgICAgICB9CiAgICAgICAgfSwKICAgICAgICByZXF1ZXN0UmVqZWN0KHJlamVjdCkgewogICAgICAgICAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgbm8tY29uc29sZQogICAgICAgICAgICBjb25zb2xlLmxvZyhyZWplY3QpOwogICAgICAgIH0sCiAgICAgICAgcmVxdWVzdE1ldGhvZCh1cmwsIGZpbmFsUGFyYW1zKSB7CiAgICAgICAgICAgIGlmICh0aGlzLnJlcXVlc3RJbnRlcmNlcHRvcikgewogICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMucmVxdWVzdEludGVyY2VwdG9yKHVybCwgZmluYWxQYXJhbXMpOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGVsc2UgaWYgKHRoaXMuRm9ybUdlbmVyYXRvckluc3RhbGxPcHRpb25zICYmIHRoaXMuRm9ybUdlbmVyYXRvckluc3RhbGxPcHRpb25zLnJlcXVlc3RJbnRlcmNlcHRvcikgewogICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuRm9ybUdlbmVyYXRvckluc3RhbGxPcHRpb25zLnJlcXVlc3RJbnRlcmNlcHRvcih1cmwsIGZpbmFsUGFyYW1zKTsKICAgICAgICAgICAgfQogICAgICAgICAgICByZXR1cm4gYXhpb3MucmVxdWVzdCh7CiAgICAgICAgICAgICAgICB1cmwsCiAgICAgICAgICAgICAgICBtZXRob2Q6ICdnZXQnLAogICAgICAgICAgICAgICAgcGFyYW1zOiBmaW5hbFBhcmFtcwogICAgICAgICAgICB9KTsKICAgICAgICB9LAogICAgfSwKfTsK"},{"version":3,"sources":["fieldButton.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;AAuBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"fieldButton.vue","sourceRoot":"node_modules/form-generator-iview/src/fields","sourcesContent":["<template>\n    <Poptip\n        v-if=\"field.confirmPoptip\"\n        confirm\n        :title=\"field.confirmPoptip.title\"\n        :placement=\"field.confirmPoptip.placement\"\n        :class=\"classes\"\n        @on-ok=\"handleClick\"\n    >\n        <Button\n            :type=\"field.subtype || 'default'\"\n            :size=\"field.size || 'default'\"\n        >{{ field.text }}</Button>\n    </Poptip>\n    <Button\n        v-else\n        :type=\"field.subtype || 'default'\"\n        :size=\"field.size || 'default'\"\n        :class=\"classes\"\n        @click=\"handleClick\"\n    >{{ text }}</Button>\n</template>\n<script>\nimport axios from '../utils/http';\nimport {classPrifix} from '../utils/const';\nexport default {\n    inject: ['form'],\n    props: {\n        field: {\n            type: Object,\n            required: true\n        },\n        apiBase: {\n            type: String,\n            default: ''\n        }\n    },\n    data() {\n        return {\n            text: ''\n        };\n    },\n    computed: {\n        classes() {\n            return `${classPrifix}-${this.field.type.toLowerCase()}`;\n        },\n    },\n    mounted() {\n        this.text = this.field.text;\n    },\n    methods: {\n        handleClick() {\n            switch (this.field.action.type) {\n                case 'ajax':\n                    this.doAjaxAction();\n                    break;\n                case 'event':\n                    this.$emit('on-button-click', {\n                        name: this.field.action.name\n                    });\n            }\n        },\n        doAjaxAction() {\n            this.loading = true;\n            let apiBase = this.apiBase || '';\n            let formModel = this.form.model;\n            let apiParams = this.field.apiParams || [];\n            let params = {};\n            let finalApi = apiBase + this.field.action.api;\n            apiParams.forEach(param => {\n                params[param] = formModel[param];\n            });\n            let finalParams = Object.assign({}, params);\n            this.requestMethod(finalApi, finalParams).then(res => {\n                this.requestResolve(res);\n            }, reject => {\n                this.requestReject(reject);\n            });\n        },\n        requestResolve(res) {\n            if (+res.status === 0 || +res.errno === 0 || +res.status === 200) {\n                this.text = res.data.text;\n                this.loading = false;\n            }\n        },\n        requestReject(reject) {\n            // eslint-disable-next-line no-console\n            console.log(reject);\n        },\n        requestMethod(url, finalParams) {\n            if (this.requestInterceptor) {\n                return this.requestInterceptor(url, finalParams);\n            }\n            else if (this.FormGeneratorInstallOptions && this.FormGeneratorInstallOptions.requestInterceptor) {\n                return this.FormGeneratorInstallOptions.requestInterceptor(url, finalParams);\n            }\n            return axios.request({\n                url,\n                method: 'get',\n                params: finalParams\n            });\n        },\n    },\n};\n</script>\n"]}]}